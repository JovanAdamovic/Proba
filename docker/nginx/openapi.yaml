openapi: 3.0.3

info:
  title: Evidencije API
  version: 1.0.0
  description: API za upravljanje predmetima, zadacima, predajama, upisima i autentikacijom korisnika.

servers:
  - url: http://localhost:8000/api
    description: Lokalni API (Docker)

tags:
  - name: Auth
  - name: Predmeti
  - name: Zadaci
  - name: Predaje
  - name: Upisi
  - name: Kalendar
  - name: Provere plagijata

paths:
  /login:
    post:
      tags: [Auth]
      summary: Prijava korisnika
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  format: email
                  example: student@example.com
                password:
                  type: string
                  example: password
      responses:
        '200':
          description: Uspešna prijava
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    example: "1|abc123..."
                  user:
                    $ref: '#/components/schemas/User'

  /me:
    get:
      tags: [Auth]
      summary: Trenutno prijavljen korisnik
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Podaci o korisniku
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'

  /logout:
    post:
      tags: [Auth]
      summary: Odjava korisnika
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Uspešna odjava

  /users:
    get:
      tags: [Auth]
      summary: Lista korisnika (admin)
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista korisnika

  /kalendar/rokovi:
    get:
      tags: [Kalendar]
      summary: Rokovi u kalendaru
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista rokova

  /predmeti/moji:
    get:
      tags: [Predmeti]
      summary: Moji predmeti
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista predmeta za trenutnog korisnika

  /predmeti:
    get:
      tags: [Predmeti]
      summary: Lista predmeta
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista predmeta
    post:
      tags: [Predmeti]
      summary: Kreiranje predmeta (admin)
      security:
        - sanctumAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PredmetPayload'
      responses:
        '201':
          description: Predmet kreiran

  /predmeti/{id}:
    get:
      tags: [Predmeti]
      summary: Jedan predmet
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '200':
          description: Predmet
    put:
      tags: [Predmeti]
      summary: Izmena predmeta (admin)
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PredmetPayload'
      responses:
        '200':
          description: Predmet izmenjen
    delete:
      tags: [Predmeti]
      summary: Brisanje predmeta (admin)
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '204':
          description: Predmet obrisan

  /zadaci:
    get:
      tags: [Zadaci]
      summary: Lista zadataka
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista zadataka
    post:
      tags: [Zadaci]
      summary: Kreiranje zadatka (profesor)
      security:
        - sanctumAuth: []
      responses:
        '201':
          description: Zadatak kreiran

  /zadaci/moji:
    get:
      tags: [Zadaci]
      summary: Moji zadaci
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista zadataka za trenutnog korisnika

  /zadaci/{id}:
    get:
      tags: [Zadaci]
      summary: Jedan zadatak
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '200':
          description: Zadatak
    put:
      tags: [Zadaci]
      summary: Izmena zadatka (profesor)
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '200':
          description: Zadatak izmenjen
    delete:
      tags: [Zadaci]
      summary: Brisanje zadatka (profesor)
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '204':
          description: Zadatak obrisan

  /predaje:
    get:
      tags: [Predaje]
      summary: Lista predaja
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista predaja
    post:
      tags: [Predaje]
      summary: Nova predaja (student)
      security:
        - sanctumAuth: []
      responses:
        '201':
          description: Predaja kreirana

  /predaje/moje:
    get:
      tags: [Predaje]
      summary: Moje predaje (student)
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista predaja trenutnog studenta

  /predaje/za-moje-predmete:
    get:
      tags: [Predaje]
      summary: Predaje za moje predmete (profesor)
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista predaja za predmete trenutnog profesora

  /predaje/export/csv:
    get:
      tags: [Predaje]
      summary: Izvoz predaja u CSV
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: CSV fajl sa predajama

  /predaje/{id}/file:
    get:
      tags: [Predaje]
      summary: Preuzimanje fajla predaje
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '200':
          description: Fajl predaje

  /predaje/{id}:
    get:
      tags: [Predaje]
      summary: Jedna predaja
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '200':
          description: Predaja
    put:
      tags: [Predaje]
      summary: Izmena predaje (profesor)
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '200':
          description: Predaja izmenjena
    delete:
      tags: [Predaje]
      summary: Brisanje predaje (student)
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '204':
          description: Predaja obrisana

  /provere-plagijata:
    get:
      tags: [Provere plagijata]
      summary: Lista provera plagijata (profesor)
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista provera plagijata

  /provere-plagijata/{id}:
    get:
      tags: [Provere plagijata]
      summary: Jedna provera plagijata (profesor)
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '200':
          description: Provera plagijata

  /predaje/{predajaId}/provera-plagijata:
    post:
      tags: [Provere plagijata]
      summary: Pokretanje provere plagijata (profesor)
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/PredajaIdParam'
      responses:
        '201':
          description: Provera plagijata pokrenuta

  /upisi:
    get:
      tags: [Upisi]
      summary: Lista upisa
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Lista upisa
    post:
      tags: [Upisi]
      summary: Kreiranje upisa (admin)
      security:
        - sanctumAuth: []
      responses:
        '201':
          description: Upis kreiran

  /upisi/{id}:
    get:
      tags: [Upisi]
      summary: Jedan upis
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '200':
          description: Upis
    put:
      tags: [Upisi]
      summary: Izmena upisa (admin)
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '200':
          description: Upis izmenjen
    delete:
      tags: [Upisi]
      summary: Brisanje upisa (admin)
      security:
        - sanctumAuth: []
      parameters:
        - $ref: '#/components/parameters/IdParam'
      responses:
        '204':
          description: Upis obrisan

components:
  securitySchemes:
    sanctumAuth:
      type: http
      scheme: bearer
      bearerFormat: API token

  parameters:
    IdParam:
      name: id
      in: path
      required: true
      schema:
        type: integer

    PredajaIdParam:
      name: predajaId
      in: path
      required: true
      schema:
        type: integer

  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
          example: 1
        ime:
          type: string
          example: Petar
        prezime:
          type: string
          example: Petrović
        email:
          type: string
          format: email
          example: petar@example.com
        uloga:
          type: string
          example: student

    PredmetPayload:
      type: object
      required: [naziv, opis]
      properties:
        naziv:
          type: string
          example: Internet tehnologije
        opis:
          type: string
          example: Predmet o web tehnologijama